{
  "name": "UBX-SEC-OSNMA",
  "protocol_version": 0,
  "fingerprint": "49f93f2820c220aa",
  "consensus": {
    "sources": [
      "X20-HPG-2.00",
      "F9-HPG-1.51",
      "X20-HPG-2.02"
    ],
    "agreement_count": 3,
    "total_count": 4,
    "confidence": "medium",
    "confidence_score": 0.675,
    "last_validated": "2025-12-30",
    "outliers": [
      {
        "source": "F9-HPG-1.50",
        "fingerprint": "39db243accc123c7",
        "discrepancy": "field count differs by -2; field at offset 2: osnmamonitoring(X2) vs nmastatus(U1); missing field at offset 3; field at offset 4: timsyncreq(X1) vs cpks(U1); ...and 8 more differences"
      }
    ]
  },
  "class_id": "0x27",
  "message_id": "0x0a",
  "description": "Galileo Open Service Navigation Message Authentication (OSNMA) security information",
  "payload_length": null,
  "fields": [
    {
      "name": "version",
      "byte_offset": 0,
      "data_type": "U1",
      "description": "Message version (0x03 for this version)"
    },
    {
      "name": "nmaHeader",
      "byte_offset": 1,
      "data_type": "X1",
      "description": "NMA header (status of the OSNMA service: NMA status, chain in force and CPKS)",
      "bitfield": {
        "bits": [
          {
            "name": "headerAuthStatus",
            "bit_start": 0,
            "bit_end": 0,
            "data_type": "U",
            "description": "Indicates if the NMA header has been authenticated."
          },
          {
            "name": "nmaStatus",
            "bit_start": 2,
            "bit_end": 3,
            "data_type": "U",
            "description": "Status of OSNMA service (as indicated by the Galileo system)"
          },
          {
            "name": "chainInForce",
            "bit_start": 4,
            "bit_end": 5,
            "data_type": "U",
            "description": "Id of the TESLA chain in force"
          },
          {
            "name": "CPKS",
            "bit_start": 7,
            "bit_end": 7,
            "data_type": "U",
            "description": "TESLA chain and public key status"
          }
        ]
      }
    },
    {
      "name": "osnmaMonitoring",
      "byte_offset": 2,
      "data_type": "X2",
      "description": "Monitoring information on OSNMA service as observed by the receiver",
      "bitfield": {
        "bits": [
          {
            "name": "osnmaEnabled",
            "bit_start": 0,
            "bit_end": 0,
            "data_type": "U",
            "description": "Flag that indicates whether OSNMA execution is enabled in the receiver"
          },
          {
            "name": "numberSVs",
            "bit_start": 5,
            "bit_end": 9,
            "data_type": "U",
            "description": "Number of SVs from which OSNMA data is being collected"
          },
          {
            "name": "nmaHeaderUpdate",
            "bit_start": 7,
            "bit_end": 8,
            "data_type": "U",
            "description": "New unauthenticated NMA header (NMA status, chain in force and CPKS) observed in the signal. Changes are pending on authentication."
          },
          {
            "name": "noData",
            "bit_start": 8,
            "bit_end": 8,
            "data_type": "U",
            "description": "If true, OSNMA data is not available for the time defined in CFG-SEC-SPOOFDET_OSNMA_DENIAL_TIME."
          },
          {
            "name": "wrongData",
            "bit_start": 9,
            "bit_end": 9,
            "data_type": "U",
            "description": "If true, OSNMA data is inconsistent."
          },
          {
            "name": "wrongFlxMac",
            "bit_start": 10,
            "bit_end": 10,
            "data_type": "U",
            "description": "If true, flexible slots authentication have failed (FLX)"
          },
          {
            "name": "wrongMaclt",
            "bit_start": 11,
            "bit_end": 11,
            "data_type": "U",
            "description": "If true, the tags sequence do not follow the MAC look-up table (MACLT)."
          },
          {
            "name": "wrongMacLt",
            "bit_start": 11,
            "bit_end": 11,
            "data_type": "U",
            "description": "If true, the tags sequence do not follow the MAC look-up table (MACLT)."
          }
        ]
      }
    },
    {
      "name": "timSyncReq",
      "byte_offset": 4,
      "data_type": "X1",
      "description": "Information related to OSNMA Time Synchronization requirement status",
      "bitfield": {
        "bits": [
          {
            "name": "timSyncEnabled",
            "bit_start": 0,
            "bit_end": 0,
            "data_type": "U",
            "description": "Flag that indicates if OSNMA must be executed applying the Time Synchronization requirement"
          },
          {
            "name": "timSyncStatus",
            "bit_start": 3,
            "bit_end": 5,
            "data_type": "U",
            "description": "Indicates if the time synchronization check has been applied."
          }
        ]
      }
    },
    {
      "name": "reserved0",
      "byte_offset": 5,
      "data_type": {
        "array_of": "U1",
        "count": 3
      },
      "reserved": true,
      "description": "Reserved"
    },
    {
      "name": "timSyncReqDiff",
      "byte_offset": 8,
      "data_type": "I4",
      "unit": "ms",
      "description": "Time difference from the Time Synchronization requirement."
    },
    {
      "name": "reserved1",
      "byte_offset": 12,
      "data_type": {
        "array_of": "U1",
        "count": 4
      },
      "reserved": true,
      "description": "Reserved"
    },
    {
      "name": "dsmAuthentication",
      "byte_offset": 16,
      "data_type": "X4",
      "description": "Information related to the DSM authentication",
      "bitfield": {
        "bits": [
          {
            "name": "dsmAuthenticationStatus",
            "bit_start": 5,
            "bit_end": 9,
            "data_type": "U",
            "description": "Indicates if the authentication of a Digital Signature Message has been performed"
          },
          {
            "name": "hashFunction",
            "bit_start": 7,
            "bit_end": 8,
            "data_type": "U",
            "description": "Last authenticated hash function that must be used"
          },
          {
            "name": "macFunction",
            "bit_start": 9,
            "bit_end": 10,
            "data_type": "U",
            "description": "Last authenticated MAC function that must be used"
          },
          {
            "name": "pubKeyId",
            "bit_start": 13,
            "bit_end": 16,
            "data_type": "U",
            "description": "Last authenticated public key Id that must be used in ECDSA verification"
          },
          {
            "name": "macLookupTable",
            "bit_start": 21,
            "bit_end": 24,
            "data_type": "U",
            "description": "Last authenticated MAC Lookup table index"
          },
          {
            "name": "keySize",
            "bit_start": 25,
            "bit_end": 28,
            "data_type": "U",
            "description": "Last authenticated TESLA key size index"
          },
          {
            "name": "macSize",
            "bit_start": 29,
            "bit_end": 31,
            "data_type": "U",
            "description": "Last authenticated MAC size index. Add an offset of 5 to obtain the index as per Table 11 of OSNMA SIS ICD, Issue 1.1"
          },
          {
            "name": "fromNVS",
            "bit_start": 30,
            "bit_end": 30,
            "data_type": "U",
            "description": "Last authenticated configuration comes from NVS"
          }
        ]
      }
    },
    {
      "name": "teslaKey",
      "byte_offset": 20,
      "data_type": "X4",
      "description": "Information related to the TESLA key authentication",
      "bitfield": {
        "bits": [
          {
            "name": "teslaKeyAuthStatus",
            "bit_start": 2,
            "bit_end": 4,
            "data_type": "U",
            "description": "Indicates if the authentication of an element of the TESLA key has been performed and the result thereof"
          },
          {
            "name": "wnSf",
            "bit_start": 14,
            "bit_end": 25,
            "data_type": "U",
            "description": "The GST week number of subframe in which the public key has been transmitted"
          },
          {
            "name": "towSf",
            "bit_start": 29,
            "bit_end": 43,
            "data_type": "U",
            "scale": {
              "raw": "1/30",
              "multiplier": 0.033333
            },
            "unit": "s",
            "description": "Seconds of week of the GST of the subframe in which the public key has been transmitted divided by 30s (subframe length)"
          },
          {
            "name": "chainId",
            "bit_start": 31,
            "bit_end": 32,
            "data_type": "U",
            "description": "Chain Id of the TESLA key that has been authenticated"
          }
        ]
      }
    },
    {
      "name": "generalAndTiming",
      "byte_offset": 24,
      "data_type": "X4",
      "description": "Information related to the overall authentication process: Timing parameters and summary of data authenticated",
      "bitfield": {
        "bits": [
          {
            "name": "authSVs",
            "bit_start": 5,
            "bit_end": 10,
            "data_type": "U",
            "description": "Total number of SVs for which orbit/clocks data authentication has been performed (ADKD types 0 or 12)"
          },
          {
            "name": "authNumTim",
            "bit_start": 11,
            "bit_end": 16,
            "data_type": "U",
            "description": "Total number of timing parameters authentications (typically one per SV sending MAC ADKD type 4)"
          },
          {
            "name": "timingAuthResult",
            "bit_start": 13,
            "bit_end": 14,
            "data_type": "U",
            "description": "Indicates if the authentication of the timing parameters (GST-UTC and GST-GPS) has been performed and the result"
          },
          {
            "name": "macAdkdType",
            "bit_start": 14,
            "bit_end": 14,
            "data_type": "U",
            "description": "Indicates if the receiver processes fast (1 subframe delay) or slow (10 subframes delay) MACs"
          },
          {
            "name": "pubKeySrc",
            "bit_start": 16,
            "bit_end": 17,
            "data_type": "U",
            "description": "Origin of the public key"
          },
          {
            "name": "merkleRootSrc",
            "bit_start": 18,
            "bit_end": 19,
            "data_type": "U",
            "description": "Origin of the Merkle tree root"
          }
        ]
      }
    }
  ]
}
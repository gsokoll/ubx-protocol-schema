{
  "message_name": "UBX-NAV-SIG",
  "num_extractions": 17,
  "adjudication": {
    "canonical_structure": {
      "name": "UBX-NAV-SIG",
      "class_id": 1,
      "message_id": 67,
      "description": "Signal information",
      "message_type": "periodic_polled",
      "payload": {
        "length": {
          "variable": {
            "base": 8,
            "formula": "8 + numSigs * 16"
          }
        },
        "fields": [
          {
            "name": "iTOW",
            "byte_offset": 0,
            "data_type": "U4",
            "unit": "ms",
            "description": "GPS time of week of the navigation epoch"
          },
          {
            "name": "version",
            "byte_offset": 4,
            "data_type": "U1",
            "description": "Message version (0x00)"
          },
          {
            "name": "numSigs",
            "byte_offset": 5,
            "data_type": "U1",
            "description": "Number of signals"
          },
          {
            "name": "reserved0",
            "byte_offset": 6,
            "data_type": "U1[2]",
            "reserved": true
          },
          {
            "name": "signals",
            "byte_offset": 8,
            "repetition_type": "count_field",
            "count_field": "numSigs",
            "group_size_bytes": 16,
            "fields": [
              {
                "name": "gnssId",
                "byte_offset": 0,
                "data_type": "U1"
              },
              {
                "name": "svId",
                "byte_offset": 1,
                "data_type": "U1"
              },
              {
                "name": "sigId",
                "byte_offset": 2,
                "data_type": "U1"
              },
              {
                "name": "freqId",
                "byte_offset": 3,
                "data_type": "U1"
              },
              {
                "name": "prRes",
                "byte_offset": 4,
                "data_type": "I2",
                "scale": 0.1,
                "unit": "m"
              },
              {
                "name": "cno",
                "byte_offset": 6,
                "data_type": "U1",
                "unit": "dBHz"
              },
              {
                "name": "qualityInd",
                "byte_offset": 7,
                "data_type": "U1"
              },
              {
                "name": "corrSource",
                "byte_offset": 8,
                "data_type": "U1"
              },
              {
                "name": "ionoModel",
                "byte_offset": 9,
                "data_type": "U1"
              },
              {
                "name": "sigFlags",
                "byte_offset": 10,
                "data_type": "X2",
                "bitfield": {
                  "health": {
                    "bit_offset": 0,
                    "num_bits": 2
                  },
                  "prSmoothed": {
                    "bit_offset": 2,
                    "num_bits": 1
                  },
                  "prUsed": {
                    "bit_offset": 3,
                    "num_bits": 1
                  },
                  "crUsed": {
                    "bit_offset": 4,
                    "num_bits": 1
                  },
                  "doUsed": {
                    "bit_offset": 5,
                    "num_bits": 1
                  },
                  "prCorrUsed": {
                    "bit_offset": 6,
                    "num_bits": 1
                  },
                  "crCorrUsed": {
                    "bit_offset": 7,
                    "num_bits": 1
                  },
                  "doCorrUsed": {
                    "bit_offset": 8,
                    "num_bits": 1
                  },
                  "authStatus": {
                    "bit_offset": 9,
                    "num_bits": 1
                  }
                }
              },
              {
                "name": "reserved1",
                "byte_offset": 12,
                "data_type": "U1[4]",
                "reserved": true
              }
            ]
          }
        ]
      }
    },
    "canonical_confidence": "high",
    "extraction_verdicts": [
      {
        "source": "u-blox-F9-TIM-2.20_InterfaceDescription_UBX-21048598",
        "verdict": "correct",
        "issues": [
          "Older version variant: missing newer sigFlags bits 6-9"
        ]
      },
      {
        "source": "F9-HPS120_Interfacedescription_UBX-19056845",
        "verdict": "correct",
        "issues": [
          "Mid-range variant: missing sigFlags bit 9 (authStatus)"
        ]
      },
      {
        "source": "u-blox-X20-HPG-2.02_InterfaceDescription_UBXDOC-304424225-19967",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-M10-SPG-5.30_InterfaceDescription_UBXDOC-304424225-20395",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox_ZED-F9H_InterfaceDescription_(UBX-19030118)",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-F9-HPS-1.30_InterfaceDescription_UBX-22010984",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-F10-SPG-6.00_InterfaceDescription_UBX-23002975",
        "verdict": "correct",
        "issues": [
          "Receiver variant: sigFlags bit 9 is reserved on F10 SPG 6.00"
        ]
      },
      {
        "source": "u-blox-F9-TIM-2.25_InterfaceDescription_UBXDOC-963802114-13231",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-F9-LAP-1.30_InterfaceDescription_UBX-22005157",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-F9-DBD-1.30_InterfaceDescription_UBX-23006360",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-M9-SPG-4.04_InterfaceDescription_UBX-21022436",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-F9-HPG-1.13_InterfaceDescription_UBX-21023318",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-F9-LAP-1.50_InterfaceDescription_UBXDOC-963802114-13052",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-M10-SPG-5.10_InterfaceDescription_UBX-21035062",
        "verdict": "correct",
        "issues": []
      },
      {
        "source": "u-blox-F9-HPG-1.32_InterfaceDescription_UBX-22008968",
        "verdict": "extraction_error",
        "issues": [
          "Incorrect relative byte offsets in repeated group (used absolute message offsets instead)"
        ]
      },
      {
        "source": "M9-ADR-5.10_InterfaceDescription_UBX-20048972_C1-Public",
        "verdict": "extraction_error",
        "issues": [
          "Incorrect relative byte offsets in repeated group (used absolute message offsets instead)"
        ]
      },
      {
        "source": "u-blox-F9-HPG-L1L5-1.40_InterfaceDescription_UBX-23006991",
        "verdict": "correct",
        "issues": []
      }
    ],
    "valid_variations": [
      {
        "sources": [
          "u-blox-X20-HPG-2.02",
          "u-blox-M10-SPG-5.30",
          "u-blox-F9-HPS-1.30"
        ],
        "structure": {
          "sigFlags": "Bit 9 defined as authStatus (Galileo OSNMA)",
          "corrSource": "Includes values 9-12 (CLAS, LPP, GAL HAS)"
        },
        "reason": "Latest firmware versions supporting Galileo authentication and high-precision correction services."
      },
      {
        "sources": [
          "u-blox-F9-TIM-2.20"
        ],
        "structure": {
          "sigFlags": "Only bits 0-5 defined"
        },
        "reason": "Legacy/Early firmware version before the addition of correction-used flags and authentication status."
      }
    ],
    "reasoning": "The UBX-NAV-SIG message is a 16-byte repeating structure. The core difference between receiver generations (F9, M9, M10, F10) is the complexity of the sigFlags bitfield and the range of values in corrSource. Older firmwares (TIM 2.20) only tracked used/smoothed flags, while newer ones added correction usage flags (bits 6-8) and OSNMA authentication status (bit 9). Extractions 15 and 16 were marked as errors because they provided byte offsets relative to the start of the entire UBX frame rather than relative to the start of the repeating block, which breaks schema logic for variable signal counts."
  }
}